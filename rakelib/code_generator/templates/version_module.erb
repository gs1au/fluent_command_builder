require File.expand_path(File.dirname(__FILE__) + '/../command_base')
require File.expand_path(File.dirname(__FILE__) + '/../underlying_builder')

module FluentCommandBuilder
  def <%= @model.version_factory_method_name %>(<%= @model.factory_method_args.join(', ') %>)
    b = UnderlyingBuilder.new
    c = <%= @model.command_module_name %>::<%= @model.version_module_name %>.create <%= (%w(b) + @model.initializer_values).join(', ') %>
    yield b if block_given?
    c
  end
  module <%= @model.command_module_name %>
    module <%= @model.version_module_name %>
      def self.create(<%= (%w(underlying_builder) + @model.factory_method_args).join(', ') %>)
        <%= @model.command_class_name %>.new <%= (%w(underlying_builder) + @model.initializer_values).join(', ') %>
      end
      def <%= @model.command_factory_method_name %>(<%= @model.factory_method_args.join(', ') %>)
        b = UnderlyingBuilder.new
        c = <%= @model.version_module_name %>.create <%= (%w(b) + @model.initializer_values).join(', ') %>
        yield b if block_given?
        c
      end
      <%= @model.command_class %>
    end
  end
end